/* DO NOT EDIT THIS FILE - it is machine generated */
#include <jni.h>
/* Header for class com_neocoretechs_cublas_Gemm */

#ifndef _Included_com_neocoretechs_cublas_Gemm
#define _Included_com_neocoretechs_cublas_Gemm
#ifdef _WIN32
#  define EXPORT __declspec(dllexport)
#else
#  define EXPORT
#endif

#ifdef __cplusplus
extern "C" {
#endif
/*
 * Class:     com_neocoretechs_cublas_Gemm
 * Method:    matrixDotProductD
 * Signature: (JII[DII[D[D)I
 */
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductD
  (JNIEnv*, jclass, jlong, jint, jint, jdoubleArray, jint, jint, jdoubleArray, jdoubleArray);

/*
 * Class:     com_neocoretechs_cublas_Gemm
 * Method:    matrixDotProductDBatch
 * Signature: (JIILjava/util/ArrayList;IILjava/util/ArrayList;Ljava/util/ArrayList;I)I
 */
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductDBatch
  (JNIEnv*, jclass, jlong, jint, jint, jobject, jint, jint, jobject, jobject, jint);

/*
 * Class:     com_neocoretechs_cublas_Gemm
 * Method:    matrixDotProductDStream
 * Signature: (JIILjava/util/ArrayList;IILjava/util/ArrayList;Ljava/util/ArrayList;I)I
 */
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductDStream
  (JNIEnv*, jclass, jlong, jint, jint, jobject, jint, jint, jobject, jobject, jint);

/*
 * Class:     com_neocoretechs_cublas_Gemm
 * Method:    matrixDotProductDCPU
 * Signature: (II[DII[D[D)I
 */
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductDCPU
  (JNIEnv*, jclass, jint, jint, jdoubleArray, jint, jint, jdoubleArray, jdoubleArray);

/*
 * Class:     com_neocoretechs_cublas_Gemm
 * Method:    matrixDotProductDCPUBatch
 * Signature: (IILjava/util/ArrayList;IILjava/util/ArrayList;Ljava/util/ArrayList;I)I
 */
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductDCPUBatch
  (JNIEnv*, jclass, jint, jint, jobject, jint, jint, jobject, jobject, jint);

/*
 * Class:     com_neocoretechs_cublas_Gemm
 * Method:    matrixDotProductF
 * Signature: (JII[FII[F[F)I
 */
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductF
  (JNIEnv*, jclass, jlong, jint, jint, jfloatArray, jint, jint, jfloatArray, jfloatArray);

/*
 * Class:     com_neocoretechs_cublas_Gemm
 * Method:    matrixDotProductFBatch
 * Signature: (JIILjava/util/ArrayList;IILjava/util/ArrayList;Ljava/util/ArrayList;I)I
 */
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductFBatch
  (JNIEnv*, jclass, jlong, jint, jint, jobject, jint, jint, jobject, jobject, jint);

/*
 * Class:     com_neocoretechs_cublas_Gemm
 * Method:    matrixDotProductFStream
 * Signature: (JIILjava/util/ArrayList;IILjava/util/ArrayList;Ljava/util/ArrayList;I)I
 */
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductFStream
  (JNIEnv*, jclass, jlong, jint, jint, jobject, jint, jint, jobject, jobject, jint);

/*
 * Class:     com_neocoretechs_cublas_Gemm
 * Method:    matrixDotProductFCPU
 * Signature: (II[FII[F[F)I
 */
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductFCPU
  (JNIEnv*, jclass, jint, jint, jfloatArray, jint, jint, jfloatArray, jfloatArray);

/*
 * Class:     com_neocoretechs_cublas_Gemm
 * Method:    matrixDotProductFCPUBatch
 * Signature: (IILjava/util/ArrayList;IILjava/util/ArrayList;Ljava/util/ArrayList;I)I
 */
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductFCPUBatch
  (JNIEnv*, jclass, jint, jint, jobject, jint, jint, jobject, jobject, jint);

/*
* Class:     com_neocoretechs_cublas_Gemm
* Method : matrixDotProductF16
* Signature : (LII[DII[D[D)I
*/
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductF16
(JNIEnv*, jclass, jlong, jint, jint, jfloatArray, jint, jint, jfloatArray, jfloatArray);

/*
 * Class:     com_neocoretechs_cublas_Gemm
 * Method:    matrixDotProductF16Batch
 * Signature: (JIILjava/util/ArrayList;IILjava/util/ArrayList;Ljava/util/ArrayList;I)I
 */
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductF16Batch
(JNIEnv*, jclass, jlong, jint, jint, jobject, jint, jint, jobject, jobject, jint);

/*
* Class:  com_neocoretechs_cublas_Gemm
* Method: matrixDotProductF32StridedBatch
* Signature : (JIILjava/util/ArrayList;IILjava/util/ArrayList;Ljava/util/ArrayList;I)I
*/
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductF32StridedBatch
(JNIEnv*, jclass, jlong, jint, jint, jobject, jint, jint, jobject, jobject, jint);

/*
* Class:  com_neocoretechs_cublas_Gemm
* Method: matrixDotProductF16StridedBatch
* Signature : (JIILjava/util/ArrayList;IILjava/util/ArrayList;Ljava/util/ArrayList;I)I
*/
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductF16StridedBatch
(JNIEnv*, jclass, jlong, jint, jint, jobject, jint, jint, jobject, jobject, jint);

JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductF16StridedBatchFlat
(JNIEnv*, jclass, jlong, jint, jint, jfloatArray, jint, jint, jfloatArray, jfloatArray, jint);

JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductF16StridedBatchFlat2
(JNIEnv*, jclass, jlong, jint, jint,  jfloatArray, jint, jint, jfloatArray, jfloatArray, jint);

/*
 * Class:     com_neocoretechs_cublas_Gemm
 * Method:    matrixDotProductF16Stream
 * Signature: (JIILjava/util/ArrayList;IILjava/util/ArrayList;Ljava/util/ArrayList;I)I
 */
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_matrixDotProductF16Stream
(JNIEnv*, jclass, jlong, jint, jint, jobject, jint, jint, jobject, jobject, jint);

/*
 * Class:     com_neocoretechs_cublas_Gemm
 * Method:    cublasHandle
 * Signature: ()J
 */
JNIEXPORT jlong JNICALL Java_com_neocoretechs_cublas_Gemm_cublasHandle
  (JNIEnv*, jclass);

/*
 * Class:     com_neocoretechs_cublas_Gemm
 * Method:    cublasHandleDestroy
 * Signature: (J)I
 */
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_cublasHandleDestroy
  (JNIEnv*, jclass, jlong);

JNIEXPORT jlongArray JNICALL Java_com_neocoretechs_cublas_Gemm_cudaMemGetInfo(JNIEnv*, jclass);
/*
* Scalar dot product of 2 of float32 cublasSdot
*/
JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_sdot(JNIEnv*, jclass, jlong, jint, jfloatArray, jint, jfloatArray, jint, jfloatArray);

JNIEXPORT jlong JNICALL Java_com_neocoretechs_cublas_Gemm_cudaMallocBytes(JNIEnv*, jclass, jlong);

JNIEXPORT void JNICALL Java_com_neocoretechs_cublas_Gemm_cudaFreePtr(JNIEnv*, jclass, jlong);

JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_cudaMemcpyHtoD(JNIEnv*, jclass, jlong, jobject, jlong);

JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_cudaMemcpyDtoH(JNIEnv*, jclass, jobject, jlong, jlong);

JNIEXPORT jint JNICALL Java_com_neocoretechs_cublas_Gemm_sdotDevice(JNIEnv*, jclass, jlong, jint, jlong, jint, jlong, jint, jlong);

JNIEXPORT jlong JNICALL Java_com_neocoretechs_cublas_Attn_convertBufferToFloat(JNIEnv*, jclass, jobject, jint, jint, jint, jint);

JNIEXPORT jfloat JNICALL Java_com_neocoretechs_cublas_Gemm_sdotSlice(JNIEnv*, jclass, jlong, jobject, jint, jobject, jint, jint);

EXPORT float sdotSliceCuBLAS(uint64_t, const float*, const float*, int);

EXPORT float sdotSliceDevice(const uint8_t*, int, int, int, int, int, const uint8_t*, int, int, int, int, int, int);

EXPORT uint64_t cublasHandle();

EXPORT void cublasHandleDestroy(uint64_t);

EXPORT int cudaGetMemInfo(size_t*, size_t*);

EXPORT uint64_t allocDevicePtr(uint64_t bytes);

EXPORT void freeDevicePtr(uint64_t d_tensor);

EXPORT void copyHostToDevice(uint8_t*, uint64_t, uint64_t);

EXPORT void copyDeviceToHost(uint64_t, uint8_t*, uint64_t);

EXPORT void launch_rmsnorm_fp32_rowmajor(uint8_t*, int, int, int, int, int, uint8_t*, int, int, int, int, int, uint8_t*, int, float);

EXPORT void launch_attention_av_weighted_sum(
    const float*,       // device pointer [nHeads*contextLen]
    const uint8_t*,  // device pointer [contextLen*kvTypeSizeTotal]
    float*,              // device pointer [nHeads*headSize]
    int, int, int, int, int, int, int, int, int,
    int,                 // 1=Q8, 2=Q4, 3=F16, 4=BF16, 5=F32
    int   // default launch config thread per block
);
/*
* launch_qk_scores_fp32_rowmajor(
*    const float* Q, const uint8_t* K, float* S,
*    int h, int nHeads, int headSize, int contextLength,
*    int kvDim, int kvMul, int tMaxInclusive, int tensorSize, float sqrtHeadSize,
*    int format, int blockSize, int typeSize, int headerBytes)
*
*/
EXPORT void launch_qk_scores_fp32_rowmajor(const float*, const uint8_t*, float*, int, int, int, int, int, int, int, int, float, int, int, int, int);

EXPORT void launch_row_softmax_fp32(const float*, float*, int, int, int, int);

EXPORT void launch_row_softmax_inplace_fp32(float*, int, int, int);

EXPORT void cudaInit();
#ifdef __cplusplus
}
#endif
#endif
